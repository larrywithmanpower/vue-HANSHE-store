(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-296c29e8"],{a434:function(e,t,c){"use strict";var a=c("23e7"),o=c("23cb"),l=c("a691"),r=c("50c4"),i=c("7b0b"),n=c("65f0"),s=c("8418"),d=c("1dde"),b=d("splice"),u=Math.max,p=Math.min,m=9007199254740991,h="Maximum allowed length exceeded";a({target:"Array",proto:!0,forced:!b},{splice:function(e,t){var c,a,d,b,g,j,O=i(this),f=r(O.length),V=o(e,f),v=arguments.length;if(0===v?c=a=0:1===v?(c=0,a=f-V):(c=v-2,a=p(u(l(t),0),f-V)),f+c-a>m)throw TypeError(h);for(d=n(O,a),b=0;b<a;b++)g=V+b,g in O&&s(d,b,O[g]);if(d.length=a,c<a){for(b=V;b<f-a;b++)g=b+a,j=b+c,g in O?O[j]=O[g]:delete O[j];for(b=f;b>f-a+c;b--)delete O[b-1]}else if(c>a)for(b=f-a;b>V;b--)g=b+a-1,j=b+c-1,g in O?O[j]=O[g]:delete O[j];for(b=0;b<c;b++)O[b+V]=arguments[b+2];return O.length=f-a+c,d}})},f957:function(e,t,c){"use strict";c.r(t);var a=c("7a23"),o={class:"table-responsive"},l={class:"table align-middle text-center"},r=Object(a["createVNode"])("thead",null,[Object(a["createVNode"])("tr",null,[Object(a["createVNode"])("th",{width:"20%"},"標題"),Object(a["createVNode"])("th",{width:"25%"},"簡介"),Object(a["createVNode"])("th",{width:"10%"},"作者"),Object(a["createVNode"])("th",{width:"15%"},"日期"),Object(a["createVNode"])("th",{width:"10%"},"是否公開"),Object(a["createVNode"])("th")])],-1),i={class:"btn-group"};function n(e,t,c,n,s,d){var b=Object(a["resolveComponent"])("Loading"),u=Object(a["resolveComponent"])("ArticleModal"),p=Object(a["resolveComponent"])("DelModal"),m=Object(a["resolveComponent"])("PreviewModal");return Object(a["openBlock"])(),Object(a["createBlock"])(a["Fragment"],null,[Object(a["createVNode"])("div",null,[Object(a["createVNode"])(b,{active:s.isLoading},null,8,["active"]),Object(a["createVNode"])("button",{type:"button",class:"btn btn-primary my-3",onClick:t[1]||(t[1]=function(e){return d.openModal("new")})}," 新增文章 "),Object(a["createVNode"])("div",o,[Object(a["createVNode"])("table",l,[r,Object(a["createVNode"])("tbody",null,[(Object(a["openBlock"])(!0),Object(a["createBlock"])(a["Fragment"],null,Object(a["renderList"])(s.articles,(function(e){return Object(a["openBlock"])(),Object(a["createBlock"])("tr",{key:e.id},[Object(a["createVNode"])("td",null,Object(a["toDisplayString"])(e.title),1),Object(a["createVNode"])("td",null,[Object(a["createVNode"])("a",{href:"#","ata-bs-toggle":"PreviewModal","data-bs-target":"#PreviewModal",onClick:Object(a["withModifiers"])((function(t){return d.openModal("preview",e)}),["prevent"])}," 預覽內容 ",8,["onClick"])]),Object(a["createVNode"])("td",null,Object(a["toDisplayString"])(e.author),1),Object(a["createVNode"])("td",null,Object(a["toDisplayString"])(new Date(1e3*e.create_at).toLocaleDateString()),1),Object(a["createVNode"])("td",null,[e.isPublic?(Object(a["openBlock"])(),Object(a["createBlock"])("span",{key:0,class:{"text-success":e.isPublic}}," 發布 ",2)):Object(a["createCommentVNode"])("",!0),e.isPublic?Object(a["createCommentVNode"])("",!0):(Object(a["openBlock"])(),Object(a["createBlock"])("span",{key:1,class:{"text-danger":!e.isPublic}}," 未發布 ",2))]),Object(a["createVNode"])("td",null,[Object(a["createVNode"])("div",i,[Object(a["createVNode"])("button",{type:"button",class:"btn btn-sm btn-outline-primary",onClick:function(t){return d.openModal("edit",e)}}," 編輯 ",8,["onClick"]),Object(a["createVNode"])("button",{type:"button",class:"btn btn-sm btn-outline-danger",onClick:function(t){return d.openModal("delete",e)}}," 刪除 ",8,["onClick"])])])])})),128))])])])]),Object(a["createVNode"])(u,{id:"ArticleModal",ref:"ArticleModal","is-new":s.isNew,article:s.tempArticle,onUpdateArticle:d.updateArticle},null,8,["is-new","article","onUpdateArticle"]),Object(a["createVNode"])(p,{id:"DelModal",ref:"DelModal",item:s.tempArticle,onDelete:d.deleteArticle},null,8,["item","onDelete"]),Object(a["createVNode"])(m,{ref:"PreviewModal",id:"PreviewModal","props-article":s.tempArticle},null,8,["props-article"])],64)}var s=c("5530"),d=(c("99af"),c("a15b"),c("a4d3"),c("e01a"),{class:"modal fade",id:"articleModal",ref:"articleModal",tabindex:"-1","aria-labelledby":"articleModalLabel","aria-hidden":"true"}),b={class:"modal-dialog modal-xl"},u={class:"modal-content"},p={class:"modal-header bg-dark text-white"},m={class:"modal-title",id:"articleModalLabel"},h=Object(a["createVNode"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),g={class:"modal-body"},j={class:"row"},O={class:"col-sm-4"},f={class:"mb-1"},V={class:"form-group"},v=Object(a["createVNode"])("label",{for:"imageUrl",class:"fw-bold"}," 主要圖片 ",-1),N={class:"form-group mb-3"},w=Object(a["createVNode"])("label",{for:"photoFile",class:"fw-bold"}," 上傳圖片檔案 ",-1),y=Object(a["createVNode"])("hr",null,null,-1),A=Object(a["createVNode"])("div",{class:"mb-1 fw-bold"}," 其他圖片 ",-1),k={key:0},M=Object(a["createVNode"])("label",{for:"imageUrl"},"圖片網址",-1),x={key:0},U={key:1},D={class:"mt-2"},C={class:"col-sm-8"},B={class:"form-group"},T=Object(a["createVNode"])("label",{for:"title"},"標題",-1),L={class:"form-group mb-3"},P=Object(a["createVNode"])("label",{for:"category"},"作者",-1),$={class:"tag-input form-group mb-3"},S=Object(a["createVNode"])("label",{for:"category"},"標籤",-1),F={class:"tags"},H=Object(a["createVNode"])("hr",null,null,-1),_={class:"form-group mb-3"},I=Object(a["createVNode"])("label",{for:"content"},"文章類別",-1),K={class:"form-group mb-3"},J=Object(a["createVNode"])("label",{for:"description"},"文章內容",-1),q=Object(a["createVNode"])("br",null,null,-1),E={class:"form-group"},z={class:"form-check"},G=Object(a["createVNode"])("label",{class:"form-check-label",for:"isPublic"}," 是否發布 ",-1),Q={class:"modal-footer"},R=Object(a["createVNode"])("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function W(e,t,c,o,l,r){var i=Object(a["resolveComponent"])("ckeditor");return Object(a["openBlock"])(),Object(a["createBlock"])("div",d,[Object(a["createVNode"])("div",b,[Object(a["createVNode"])("div",u,[Object(a["createVNode"])("div",p,[Object(a["createVNode"])("h5",m,Object(a["toDisplayString"])(c.isNew?"新增文章":"編輯文章"),1),h]),Object(a["createVNode"])("div",g,[Object(a["createVNode"])("div",j,[Object(a["createVNode"])("div",O,[Object(a["createVNode"])("div",f,[Object(a["createVNode"])("div",V,[v,Object(a["withDirectives"])(Object(a["createVNode"])("input",{"onUpdate:modelValue":t[1]||(t[1]=function(e){return l.tempArticle.imageUrl=e}),type:"text",class:"form-control",placeholder:"請輸入圖片連結"},null,512),[[a["vModelText"],l.tempArticle.imageUrl]])]),Object(a["createVNode"])("img",{class:"img-fluid",src:l.tempArticle.imageUrl},null,8,["src"])]),Object(a["createVNode"])("div",N,[w,Object(a["createVNode"])("input",{type:"file",id:"photoFile",class:"form-control",placeholder:"請輸入圖片路徑",onChange:t[2]||(t[2]=function(){return r.uploadImage&&r.uploadImage.apply(r,arguments)})},null,32)]),y,A,Array.isArray(l.tempArticle.imagesUrl)?(Object(a["openBlock"])(),Object(a["createBlock"])("div",k,[(Object(a["openBlock"])(!0),Object(a["createBlock"])(a["Fragment"],null,Object(a["renderList"])(l.tempArticle.imagesUrl,(function(e,t){return Object(a["openBlock"])(),Object(a["createBlock"])("div",{class:"mb-1",key:t},[M,Object(a["withDirectives"])(Object(a["createVNode"])("input",{"onUpdate:modelValue":function(e){return l.tempArticle.imagesUrl[t]=e},type:"text",class:"form-control",placeholder:"請輸入圖片連結"},null,8,["onUpdate:modelValue"]),[[a["vModelText"],l.tempArticle.imagesUrl[t]]]),Object(a["createVNode"])("img",{src:l.tempArticle.imagesUrl[t],class:"img-fluid"},null,8,["src"])])})),128)),!l.tempArticle.imagesUrl.length||l.tempArticle.imagesUrl[l.tempArticle.imagesUrl.length-1]?(Object(a["openBlock"])(),Object(a["createBlock"])("div",x,[Object(a["createVNode"])("button",{type:"button",class:"btn btn-outline-primary btn-sm d-block w-100",onClick:t[3]||(t[3]=function(e){return l.tempArticle.imagesUrl.push("")})}," 新增圖片 ")])):(Object(a["openBlock"])(),Object(a["createBlock"])("div",U,[Object(a["createVNode"])("button",{type:"button",class:"btn btn-outline-danger btn-sm d-block w-100",onClick:t[4]||(t[4]=function(e){return l.tempArticle.imagesUrl.pop()})}," 刪除空白圖片網址 ")]))])):Object(a["createCommentVNode"])("",!0),Object(a["createVNode"])("div",D,[Object(a["createVNode"])("button",{type:"button",class:"btn btn-sm btn-danger d-block w-100",onClick:t[5]||(t[5]=function(e){return r.removeImages()})}," 刪除圖片 ")])]),Object(a["createVNode"])("div",C,[Object(a["createVNode"])("div",B,[T,Object(a["withDirectives"])(Object(a["createVNode"])("input",{"onUpdate:modelValue":t[6]||(t[6]=function(e){return l.tempArticle.title=e}),id:"title",type:"text",class:"form-control",placeholder:"請輸入標題"},null,512),[[a["vModelText"],l.tempArticle.title]])]),Object(a["createVNode"])("div",L,[P,Object(a["withDirectives"])(Object(a["createVNode"])("input",{"onUpdate:modelValue":t[7]||(t[7]=function(e){return l.tempArticle.author=e}),id:"category",type:"text",class:"form-control",placeholder:"請輸入您的大名"},null,512),[[a["vModelText"],l.tempArticle.author]])]),Object(a["createVNode"])("div",$,[S,Object(a["createVNode"])("ul",F,[(Object(a["openBlock"])(!0),Object(a["createBlock"])(a["Fragment"],null,Object(a["renderList"])(l.tempArticle.tag,(function(e,t){return Object(a["openBlock"])(),Object(a["createBlock"])("li",{key:e,class:"tag"},[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e)+" ",1),Object(a["createVNode"])("button",{class:"delete",onClick:function(e){return r.removeTag(t)}},"x",8,["onClick"])])})),128))]),Object(a["withDirectives"])(Object(a["createVNode"])("input",{"onUpdate:modelValue":t[8]||(t[8]=function(e){return l.newTag=e}),class:"form-control",type:"text",style:{"padding-left":"".concat(l.paddingLeft,"px")},onKeydown:[t[9]||(t[9]=Object(a["withKeys"])((function(e){return r.addTag(l.newTag)}),["enter"])),t[10]||(t[10]=Object(a["withKeys"])(Object(a["withModifiers"])((function(e){return r.addTag(l.newTag)}),["prevent"]),["tab"])),t[11]||(t[11]=Object(a["withKeys"])((function(t){return l.newTag.length||r.removeTag(e.tags.length-1)}),["delete"]))]},null,36),[[a["vModelText"],l.newTag]])]),H,Object(a["createVNode"])("div",_,[I,Object(a["withDirectives"])(Object(a["createVNode"])("textarea",{"onUpdate:modelValue":t[12]||(t[12]=function(e){return l.tempArticle.content=e}),id:"content",type:"text",class:"form-control",placeholder:"請輸入文章類別",rows:"1"},"\n                ",512),[[a["vModelText"],l.tempArticle.content]])]),Object(a["createVNode"])("div",K,[J,q,Object(a["createVNode"])("p",{innerHTML:l.tempArticle.description},null,8,["innerHTML"]),Object(a["createVNode"])(i,{editor:l.editor,modelValue:l.tempArticle.description,"onUpdate:modelValue":t[13]||(t[13]=function(e){return l.tempArticle.description=e}),config:l.editorConfig},null,8,["editor","modelValue","config"])]),Object(a["createVNode"])("div",E,[Object(a["createVNode"])("div",z,[Object(a["withDirectives"])(Object(a["createVNode"])("input",{"onUpdate:modelValue":t[14]||(t[14]=function(e){return l.tempArticle.isPublic=e}),id:"isPublic",class:"form-check-input",type:"checkbox","true-value":!0,"false-value":!1},null,512),[[a["vModelCheckbox"],l.tempArticle.isPublic]]),G])])])])]),Object(a["createVNode"])("div",Q,[R,Object(a["createVNode"])("button",{type:"button",class:"btn btn-primary",onClick:t[15]||(t[15]=function(t){return e.$emit("update-article",l.tempArticle)})}," 確認 ")])])])],512)}c("a434");var X=c("7c2b"),Y=c.n(X),Z=c("fb3d"),ee=c.n(Z),te={props:["article","isNew"],emits:["update-article"],data:function(){return{articleModal:{},tempArticle:{},newTag:"",paddingLeft:10,editor:ee.a,editorData:"<p>Content of the editor.</p>",editorConfig:{placeholder:"請輸入文章...",heading:{options:[{model:"paragraph",title:"Paragraph",class:"ck-heading_paragraph"},{model:"heading1",view:"h2",title:"Heading 1",class:"ck-heading_heading1"},{model:"heading2",view:"h3",title:"Heading 2",class:"ck-heading_heading2"}]},language:"tw"}}},mounted:function(){this.articleModal=new Y.a(this.$refs.articleModal)},watch:{article:function(){this.tempArticle=this.article}},methods:{showModal:function(){this.articleModal.show()},hideModal:function(){this.articleModal.hide()},uploadImage:function(){var e=this,t=document.querySelector("#photoFile"),c=t.files[0],a=new FormData;a.append("file-to-upload",c);var o="".concat("https://vue3-course-api.hexschool.io","/api/").concat("larry","/admin/upload");this.$http.post(o,a).then((function(c){c.data.success&&(e.tempProduct.imageUrl?e.tempArticle.imagesUrl.push(c.data.imageUrl):e.tempArticle.imageUrl=c.data.imageUrl,t.value="")})).catch((function(t){e.$swal({icon:"error",title:"Oops...",text:"Something went wrong!",footer:t})}))},removeImages:function(){this.tempArticle.imagesUrl.length?this.tempArticle.imagesUrl.pop():this.tempArticle.imageUrl=""},addTag:function(e){this.tempArticle.tag.push(e),this.newTag=""},removeTag:function(e){this.tempArticle.tag.splice(e,1)}}};te.render=W;var ce=te,ae={class:"modal",tabindex:"-1",ref:"previewModal",id:"previewModal"},oe={class:"modal-dialog modal-lg"},le={class:"modal-content"},re=Object(a["createVNode"])("div",{class:"modal-header"},[Object(a["createVNode"])("h5",null,"文章預覽"),Object(a["createVNode"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),ie={class:"modal-body"},ne={class:"d-flex justify-content-between mb-3"},se={class:"text-muted"},de={class:"text-muted"},be={class:"text-center"},ue=Object(a["createVNode"])("div",{class:"modal-footer"},[Object(a["createVNode"])("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ")],-1);function pe(e,t,c,o,l,r){return Object(a["openBlock"])(),Object(a["createBlock"])("div",ae,[Object(a["createVNode"])("div",oe,[Object(a["createVNode"])("div",le,[re,Object(a["createVNode"])("div",ie,[Object(a["createVNode"])("div",ne,[Object(a["createVNode"])("small",se," made by "+Object(a["toDisplayString"])(c.propsArticle.author),1),Object(a["createVNode"])("small",de," 更新日期："+Object(a["toDisplayString"])(new Date(1e3*c.propsArticle.create_at).toLocaleDateString()),1)]),Object(a["createVNode"])("h2",be,Object(a["toDisplayString"])(c.propsArticle.title),1),Object(a["createVNode"])("img",{class:"d-block mx-auto img-fluid mb-3",src:c.propsArticle.imageUrl,alt:"文章相片"},null,8,["src"]),Object(a["createVNode"])("p",{innerHTML:c.propsArticle.description},null,8,["innerHTML"])]),ue])])],512)}var me={props:["propsArticle"],data:function(){return{previwModal:{},article:{}}},mounted:function(){this.previewModal=new Y.a(this.$refs.previewModal)},methods:{showModal:function(){this.previewModal.show()},hideModal:function(){this.previewModal.hide()}}};me.render=pe;var he=me,ge=c("6ff1"),je={data:function(){return{isLoading:!1,articles:[],isNew:!1,tempArticle:{tag:[],imagesUrl:[]}}},inject:["emitter"],components:{ArticleModal:ce,DelModal:ge["a"],PreviewModal:he},created:function(){this.getArticles()},methods:{getArticles:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.isLoading=!0;var c="".concat("https://vue3-course-api.hexschool.io","/api/").concat("larry","/admin/articles?page=").concat(t);this.$http.get(c).then((function(t){t.data.success?(e.articles=t.data.articles,e.isLoading=!1):(e.emitter.emit("push-message",{style:"danger",title:"文章取得失敗",content:t.data.message.join("、")}),e.isLoading=!1)})).catch((function(e){console.log(e)}))},openModal:function(e,t){switch(e){case"new":this.isNew=!0,this.tempArticle={create_at:Math.floor(Date.now()/1e3),isPublic:!1,tag:[],imagesUrl:[]},this.$refs.ArticleModal.showModal();break;case"edit":this.isNew=!1,t.tag?this.tempArticle=Object(s["a"])(Object(s["a"])({imagesUrl:[]},t),{},{content:"新品文章"}):this.tempArticle=Object(s["a"])(Object(s["a"])({imagesUrl:[]},t),{},{tag:[],content:"新品文章"}),this.$refs.ArticleModal.showModal();break;case"delete":this.tempArticle=Object(s["a"])({},t),this.$refs.DelModal.showModal();break;case"preview":this.tempArticle=Object(s["a"])({},t),this.$refs.PreviewModal.showModal();break;default:break}},updateArticle:function(e){var t=this;this.tempArticle=e;var c="".concat("https://vue3-course-api.hexschool.io","/api/").concat("larry","/admin/article"),a="post";this.isNew||(c="".concat("https://vue3-course-api.hexschool.io","/api/").concat("larry","/admin/article/").concat(this.tempArticle.id),a="put"),this.$http[a](c,{data:e}).then((function(e){e.data.success?(t.emitter.emit("push-message",{style:"success",title:e.data.message}),t.getArticles(t.currentPage),t.$refs.ArticleModal.hideModal()):t.emitter.emit("push-message",{style:"danger",title:"更新失敗",content:e.data.message.join(",")})}))},deleteArticle:function(e){var t=this,c="".concat("https://vue3-course-api.hexschool.io","/api/").concat("larry","/admin/article/").concat(e.id);this.$http.delete(c).then((function(e){e.data.success?(t.emitter.emit("push-message",{style:"success",title:e.data.message}),t.getArticles(),t.$refs.DelModal.hideModal()):t.emitter.emit("push-message",{style:"danger",title:e.data.message})})).catch((function(e){t.$swal({icon:"error",title:"Oops...",text:"Something went wrong!",footer:e})}))}}};je.render=n;t["default"]=je}}]);
//# sourceMappingURL=chunk-296c29e8.3cdeefad.js.map